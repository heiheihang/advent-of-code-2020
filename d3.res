let data = list{".....#.........#...#..##....#..", ".#........#...#........#.......", "......#......#..#...#....#.#..#", "...#.#####.#.......##.#........", "...........#......#..#.....#...", "#.#..#...#.#...#.##.....#.....#", "....#..#....#...#.#...#.##.....", "##...#..........##..######.....", ".....#...#......#.............#", "........##....#...##..#....#...", "...#...#.........#.#..........#", "..#.#.....##..........#........", "##.......................#.....", "#..#...##...##.#.........##....", ".#....#.#####....#...#...#.....", "#......#......###..#........#.#", ".#....##..##.###.#.......#.....", ".#..#.........##....#.#....#...", "........#..................#...", ".......#..#..#............#....", "........#...................##.", ".#......#......#.####......#...", "..###.#..#..#.........#........", "..#...........###..#.....#.##..", "...#.##.#....#................#", "#.....#.............#.#........", ".#..............#.........#....", "##.................#..........#", ".#..#....#.###....##..#..#...#.", "##........#......##.....#....##", "#......#..#........#......#.#..", "....#.##.#.............#...##..", ".#...#...#..#............##...#", ".#..#...#..#..#....##..#.#.#...", "#....#...##.#.#......#........#", "#..#..#...#.#.....#..##.#......", ".....#..#.#..#.##.......#..###.", "#......#......#...#............", ".....#......#......#..#.##..#.#", "......#..##..#.....#....#......", "..#..#...#..#...#....###.#.#...", ".................#..#..........", "......#...##..#.....#...##.....", "..#...............#...#.#.....#", ".#....#.##.##..#.........##....", "...###....##...#......#......##", "....#...#.....#.........#..##..", "..###.........#..#..#...#......", "...##.....#.........#.......#..", ".....#.................#.#.....", ".#.###.#..#...#..##....#....##.", "....#.....##.........#.#.......", ".#.#....#..#................#..", "..#.#......#......#........#...", "#........#....#..#..#..#....#.#", "#...........##..#....#..####...", ".....#.......#.#...#.#....###..", ".......#....#.......#..........", ".............#.....#...........", "#....#......#...#..##.#........", "....#.......#.#.......#....###.", ".####.#...........#.#.#...#.#..", "#..##....##.#......#...........", "...##...#.#.....#.....#........", "...#.............#.....#...#...", "...#.....#..#.....##...###..#.#", "....##..#..##..#..#...#.....#..", "........#...................##.", "....#.......#.....#.......#....", "....##.........#.#.............", "......#..#........#.#...#......", ".#..#...#...........#......#..#", ".#....#.#........#............#", "......#...................#...#", "##...#.......................#.", "........###.......#.......#..#.", "...........##.............#....", "..##...#.....#....#......#....#", "................###...##...#.#.", "..#.#.....#....##...#..##......", ".....................#.#......#", ".......#....##.#..#........##..", ".##....#......#....#.........#.", "#............#.........#..#.#..", "....#...........#..#....#....##", ".......#..#.....##.........#...", ".##..........#.#.#....#..#.....", "........#....##.##.#......#....", "....##..##......##.....#.###...", "......##.#....##.#.#....#......", "..#..#..........#.....##.....##", "#........#.##...#.#....#....###", "........##............#........", "##.##..##.#..#...##............", "....#..#....#...........#....#.", "..#.......#.#.......#...#......", ".#..........##.....#..#...#...#", ".................##.#...#...##.", "##.............#......#....#...", "..........#.#....#.............", "...##..#.#.....#.....#.#.......", "...##...##.#......#.#...#......", "..#..#.....##..##..........##..", "......##........##.......#....#", "....#..####..#...##........#...", "#.......#....#.......##.......#", "........#..........#.........#.", ".....#....#.........#.#.#.....#", "..##.....#....#....#..#......#.", "....#..#.##...#..#.....#......#", "........###.........#..###...#.", ".....#.......#.....#.#.#.......", "...##.....#....##.....#.#.#...#", "#.##....#.##.....#.#.#........#", ".##..#.......#...#.#.......#...", ".#..........#.............#....", ".#...#...#......#..##..........", ".......................#.#....#", "............###....#..##.#..#..", "...#.#......##....#..#.........", "..#...#....#....#.#............", "..#.#..###...............##....", ".....##...#.....#........#..#.#", "...........#......#..#...#.##.#", "#...##......##...#..#...#..#...", "..##....#............#......#.#", ".#.#..#...#...#.#...#...##..##.", "..#.#....#.......#.#.#.#.#.##..", "....###.##..#...##....#........", ".#...............#........#....", "...#..#........##...#.##.......", "........#..#..#......##........", "##....#....#............#......", "#....#...#.###.#.###.......#...", "...#.###.##....#.........#...##", "..#......##.#.....#..#.......#.", "##.............#..#..##....#.#.", "#...#...##........#.#.......#..", "........#..#.....#.#..#..#.#...", "#..##.........#.#.#.##...#....#", "............#...#....#..#....#.", ".....#.......#......##..#......", ".#.....................#......#", "...................#....#.#....", ".....#....#.....##.............", "#....##.#....##..#....##....#..", "....#..........#..........#....", ".....#.#...............#..##...", "...#......###.......#..##......", "#.#.#....##..#......#.##.#.....", ".#...###..#.....##.........#.#.", "..#...#.............#....#.....", "#..#.............#.....#.....#.", ".#.........#.#...#..#....#...#.", "#....#......#....#.#..........#", ".........................#.....", "...................#...........", "#.#...#......#....#............", ".#..#........#...##....#....#..", "..#......#..#..........##......", "#.#....#....##....#.........#..", "...#.#.#.#..#....##..#....#..#.", "..#..............#.....##......", "....#.........#...#.....#..#...", "..#..................#.#.......", ".....##.##........#.#....#..###", "..#.#...#.....#..##..##.#.#.#..", ".....#......#............#.....", ".#.......#....##...............", "...#.................#.....#...", "...#.#..#.#...##........#....##", "..........##...................", "#........#..........#.#........", "................#..##.##.#....#", "....##..#.#.#...#...#....#.#.#.", "..#.........#......##....#.....", ".##.........#.....#.#..........", "...##...###...........#......##", "..#........#......#.....##.#...", "###.....#.#.#...#.......#....#.", "..##...#....###..##.#.#..##....", "..###...##.......#.#..#....#..#", "..#...............###....#..#..", "...........#....#.##..#........", ".#...#..#.#...##..#....#...#..#", "..#............#......#.....#..", ".#...#...#.#...#.#.............", "...####.........#....##....#.#.", ".....##...#........#.#......#..", "...####...#.#..#.#.#.#.........", "........#.##.#..#.......#......", "......##......#.........#.#....", "..#.#...#....#.....###.....##..", "#.#.##..........#...##..#..#.#.", ".....#................#.#..#..#", ".........#........#.....#..#..#", "......#...........#...........#", "..#........#.#.........#...##..", ".....####.....#....##.#........", "....#...#........#.......#...#.", "...#..#....#.....##....###.....", "........#..#..#.#.#............", "#..#......#..#....#....#.#.#..#", ".........#...#......##.........", "..#....#............#..#.....#.", "#............#.#...#......#...#", "..#..##...#........#.........##", ".#...#....##...#.......#..##...", "#..#.##......#........##...#...", "...#..........#...#..#..#....#.", "##..#........##..##...#..###.#.", "............##...............#.", "#......#...#....#.........#...#", "................#..#.#.........", ".....#...#...#...##.......#...#", "..##.###...#...#.#..##.#.#...#.", "#...##..........#....##.#.#.#..", ".#.........#..........#........", ".......#.#...............#.....", "...#...#............#..........", ".........#..#..........#.......", ".........#..#...#....#.##....#.", "..#............#......#....#.##", "...#...#.#........#......#..#.#", "........#......##...##...#..#.#", ".......###......#............#.", "#.....#...##.#.#...#.......#.#.", "..#......#..............##....#", "..#............##.......#.#.#.#", "...#.#.....#.#.#........####...", "...#................#..........", "..#...#....#....#......#..#...#", ".###......#..............#.#..#", "......#......#..........##..#..", "...##.#...........#.#.....##.#.", ".#...#......#..........#.......", "....#...#....#..........#.#....", "..................##..#.....#.#", "###.................#......##..", ".....#.....#............#.#..#.", ".....#........#...#....#.#.....", "#.#...#........................", ".#...#.......#..#.......#......", ".......#.#.....###.#...#.#.....", "#...#.#...........##...#.......", ".#.......#.....#..#..#....#....", "...#..##.....#..#..#.....#.....", "...#................###......#.", "#..#...##.###..#..##.......#...", ".#.#.#........#.#.............#", "#.......#..#.......#.....##...#", ".#.#.#............#..#....#.#..", "...#.#.##.#......##.....#....##", "#............###...#....#......", ".....#..#..#.#.........##.#....", ".#.##........#.#.#...#.......#.", "..###..#..#.#...#.##...###.....", "#............#.............#...", ".#.##.....#..#.......#...#...#.", ".#...#........###...####.......", ".#.#..##..#.....#.#..#.........", "....#.#.#............##..#...#.", "###.##......#.#.....#.....#....", ".........#...##.....##....#....", "..#................#.........#.", "#.......###..##..##............", ".....#...#.............#..#..#.", "..........#...................#", "....#....#...........#.........", ".##.......##.##.........##.....", "#......#.#....#....#...#.#.#...", "..#.##..#.###.#.##....#..#.....", "#....##.#...#..................", ".......#...#...........#...#...", "....###.#...#..#...............", "##.#.#..#.#......#.#......#...#", ".............#.....#.##....#...", "#.............###....#...#.##.#", "#..#.##.............#.##...#...", ".#.#......#.........#...#......", ".#.........#.#.#.....##.#.#....", ".................#........#....", "....##.#.#..#.........#........", "#...##......##....#.#..#......#", "..........##...##..#......##...", 
"..........#..#.#..##..#..#.....", "..#..#.....##........#...#.#...", "#..........#.#.#..............#", "#..........##.....#.#...##....#", ".....#...#..#..#...##.#.......#", ".##.#...............#.#...#....", "..........#.....#......#.......", ".....#.#......##...#.......#...", "...........#.#...#.....#....#.#", ".###.#........##....#.##...#...", "#....#.##....#.###..##.#.......", "##...........#..##.........#...", "....#.##...#...#.....#.#..#....", "........#.#.#..#.#...........##", "..........#.##...#....#......#.", ".##.....#.#.....##.#.......#.#.", ".#..#....#.#.....#.##.#....#..#", "#.......#..#..........##....#..", ".#........#...#..#.#...#....#..", "#......##...#...##..#.#.......#", ".#......#.##.#............##.#.", ".#....#.....##..##..........#..", "..###..#..#...#...#.#.#..##....", ".#.#.##...#..#...........#....#", "....#......#.......##...#.#.#..", ".......#..#...##..#.........#..", "....#..#.#.......##........#..#", "........#.#....#.##..#.......#.", ".....#.......#.#...#.#.........", "........#...#....#.#....###..#.", "......#..#.##..##..#...#.#.....", ".#.#.....#.....#....#...#...#..", "...#..#...#..#......#..#.#.....", "...##...#...........#..#......#", "..#...#####..#.#.##....##......", "...........#......#.#..#.......", "..#....##..#.##.......#.#.#..#.", "..#..#........#...#.......#...."}

let slopes = list{(1,1),(3,1),(5,1),(7,1),(1,2)}

let func2 = (~str as str, ~pos as pos) => {
    //let new_pos = mod((pos + 3),  Js.String2.length(str))
    switch Js.String2.charAt(str, pos) == "#" {
        |true => 1
        |false => 0
    }
}

let rec func1 = (~xmove as xmove, ~ymove as ymove, ~col_cnt as col,  ~pos as pos, ~cnt as cnt, ~l as l) => {
    switch l{
        |list{} => cnt 
        |list{a,...rest} => {
            switch col == ymove {
                |false => func1(~xmove=xmove, ~ymove=ymove, ~col_cnt = col+1, ~pos=pos, ~cnt=cnt, ~l=rest)
                |true => func1(~xmove=xmove,~ymove=ymove, ~col_cnt=1, ~pos = mod((pos+xmove),  Js.String2.length(a)), ~cnt= cnt + func2(~str=a, ~pos=pos),~l=rest)
            } 
        }
    }
}

let rec func0 = ( ~cnt as cnt, ~l as l) => {
    switch l {
        |list{} => cnt 
        |list{a,...rest} => {
            let (xmove, ymove) = a
            func0(~cnt = cnt * func1(~xmove=xmove, ~ymove=ymove,~col_cnt=ymove, ~pos=0, ~cnt=0,~l=data), ~l=rest)
        }
    }
}

let res = func0(~cnt=1,~l=slopes)

Js.log(res)